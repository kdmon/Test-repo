<!DOCTYPE html>
<html>

  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Knockoutjs.com - Control types example - jsFiddle demo</title>
    <script type='text/javascript' src='//code.jquery.com/jquery-1.9.1.js'></script>
    <script type='text/javascript' src="http://knockoutjs.com/downloads/knockout-3.0.0.js"></script>
    <script type='text/javascript' src="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js"></script>
    <link rel="stylesheet" type="text/css" href="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
    
    @media ( min-width: 40em ) {
      /* Show the table header rows and set all cells to display: table-cell */
      #ggcindications td,
      #ggcindications th,
      #ggcindications tbody th,
      #ggcindications tbody td,
      #ggcindications thead td,
      #ggcindications thead th {
        border: 1px solid #000;
        display: table-cell;
        margin: 0;
      }
      
      /* Hide the labels in each cell */
      #ggcindications td .ui-table-cell-label,
      #ggcindications th .ui-table-cell-label {
        display: none;
      }
    }

    #ggcindications tr, #ggcindications th {
      border: 1px solid #000;
      text-align: left;
    }
    
    </style>
  </head>

  <body>
    <div data-role="page" id="front" style="padding: 0px;">
      <div data-role="main" class="ui-content" style="min-height:600px; padding: 0px;">
        <div id="questionContainer" style="padding: 10px;">
          <div style="border: 1px solid #aaa;">
            <div style="background: #0F0; white-space: nowrap; line-height: 1em;  text-align: center; font-size: 0.7em;" data-bind="style: {width: 100/questionBank.pageCount() * (questionBank.currentPage()-1) + 1 + '%'}, text:  Math.round(100/questionBank.pageCount() * (questionBank.currentPage()-1)) + 1 + '% completed' "></div>
          </div>
          
           <ul style="margin:0px; padding-left: 0px; list-style: none;" data-bind="foreach: questionBank.currentPageData">
            <li>"<i data-bind="text: value"></i>" <b data-bind="text: question"></b>
              <br/> <a href="#" data-role="button" data-bind="visible: $root.questionBank.currentPage() > 1, click: $root.questionBank.movePrevious" data-inline="true"><i class="fa fa-angle-left 2x"></i></a>
              <select id="selector" data-inline="true" data-native-menu="true" data-bind="options: options, value: selected"></select> <a href="#" data-theme="b" data-role="button" data-bind="visible: selected() !== 'Please select', click: $root.questionBank.moveNext" data-inline="true">Next</a>
            </li>
            <li></li>
          </ul>
          
          <ul style="margin:0px; padding-left: 0px; list-style: none;" data-bind="foreach: questionBank.currentPageData">
            <li>- "<i data-bind="text: value"></i>" 
              <br/>
              <select id="selector" data-inline="true" data-native-menu="true" data-bind="options: options, value: selected"></select>
            </li>
          </ul>
          <a href="#" data-theme="b" data-role="button" data-bind="click: $root.questionBank.moveNext" data-inline="true">Next</a>
        </div>
        <p>Please answer as fast as possible without consulting any external resources.</p>
        <iframe id="help" src="http://optimalblooduse.eu/app/#front" width="100%" style="min-height:2600px; border: 0px; border-top: 5px solid black;"></iframe>
        
        <div style="padding: 10px;border: 0px; border-top: 5px solid black;" id="ggc">
          <i>Extract from NHS Greater Glasgow and Clyde Blood Transfusion Special Requirements Guideline (March 2013, issue 1), pages 1-8:</i>
        
          <h3>Introduction</h3>
          <p>
            This guideline is for all staff involved in prescribing, supplying and administering blood and blood components throughout Greater Glasgow and Clyde Health Board (GG&amp;C).
            It should be used in conjunction with the GG&amp;C Clinical Transfusion Policy. 
            The aim of the Clinical Transfusion policy is to ensure that the <b>right</b> blood is given to the <b>right</b> patient at the <b>right</b> time, <b>every</b> time. This policy focuses on those patients who have a special requirement for transfusion and it aims:
          </p>
          <ul>
            <li>To provide healthcare professionals with clear guidelines on when Cytomegalovirus (CMV) seronegative components, irradiated components, or other special requirements for transfusion are indicated</li>
            <li>To outline the process of notification to the hospital Blood Bank, of patients with special requirements </li>
            <li>To outline how this information will be disseminated across Greater Glasgow and Clyde</li>
            <li>To outline how errors should be reported if they arise.</li>
          </ul>
          <p>
           Advice on blood transfusion may be obtained from Biomedical Scientist (BMS) staff in Blood Bank, from Haematology Medical Staff and from hospital Transfusion Practitioners.
          </p>
          <b><i>[NB: Contact details not reproduced in this extract.]</i></b>
          <p>
            This policy has been prepared for the GG&amp;C Overarching Transfusion Committee and represents current standards. 
            It will be reviewed every two years to accommodate future changes in the provision of health care in GG&amp;C and in the provision of blood and blood components.
          </p>
          <h3>REASON FOR SPECIAL REQUIREMENTS AND IDENTIFICATION OF PATIENTS</h3>
          <ul><li> Special requirements cover a range of additional specifications or processing of standard blood components</li></ul>
          <p>The most commonly requested special requirements in practice are irradiated components and CMV seronegative components. </p>
          <h3>CMV Seronegative Components</h3>
          <p>
            Cytomegalovirus (CMV) belongs to the herpes family and in the healthy population causes a self
            limiting illness. It is cell associated and therefore can be transmitted in cellular blood components
            (red cells, platelets and granulocytes). Typically it causes a subclinical illness similar to infectious
            mononucleolus (glandular fever). In immunocompromised patients it can result in potentially fatal
            pneumonitis or disseminated CMV. For this reason CMV seronegative products should be used for
            a selected group of patients, listed below.
          </p>
          <p>
            The requirement for CMV seronegative blood components has been recently reviewed by the
            Advisory Committee on the Safety of Blood, Tissue and Organs (SaBTO). Universal leucodepletion,
            introduced by the UK blood services in 1999 primarily as a vCJD risk reduction measure, results in a
            three log depletion of white cells. This is generally accepted to render these components "CMV safe"
          </p>
          <p>
            Monitoring selected patient groups for CMV infection with pre-emptive therapy where required has
            been shown to be a successful strategy in certain groups (solid organ transplants, haematopoietic
            stem cell transplants).
          </p>
          <p>
            CMV seronegative components should continue to be used where leucodepletion is not possible
            (granulocyte transfusions) or where the potential severity of the consequences of CMV infection,
            and/or the difficulty in monitoring for infection are considered too great (IUT and transfusions in
            neonates up to 28 days post EDD, elective transfusions in pregnancy).
          <p>
          <p>
            Pregnant women who are being regularly transfused throughout their pregnancy should receive
            CMV seronegative components. There is no requirement for this for emergency transfusions in
            pregnancy.
          </p>
          <p>
            As CMV is a common virus and the prevalence of anti-CMV in the UK adult population is 50-60%, it
            not possible to provide CMV seronegative products for all recipients. Components that have been
            leucocyte depleted to less than 5 x 10^6/unit have a significant reduction in the risk of CMV
            transmission.
          </p>
          
          <i><b>[NB: IgA Deficiency section not reproduced in this extract.]</b></i>
          
          <h3>Irradiated Components</h3>
          <p>
            Irradiation is the only known method of preventing Transfusion Associated Graft versus Host
            Disease (TaGvHD). This is a rare but fatal complication of blood transfusion. It results from
            engraftment and clonal expansion of HLA compatible donor lymphocytes. Clinically TaGvHD
            presents with fever, rash, diarrhoea, hepatitis and pancytopenia 4-30 days after transfusion. This
            complication of transfusion is eliminated by inactivation of donor lymphocytes by irradiation. The risk
            associated with individual transfusions depends on the number and viability of contaminating
            lymphocytes, susceptibility of the host's immune system to their engraftment and the degree of
            immunological disparity between donor and recipient. 
            <sup><a href="#ref2">2</a>,<a href="#ref3">3</a></sup>
          </p>
          <p>
            The table below identifies the patients who have requirements for irradiated and / or CMV
            seronegative components and the length of time these are required.
          </p>
          
          <table id="ggcindications" data-role="table">
            <thead>
              <tr>
                <th>Condition:</th>
                <th>Cytomegalovirus CMV Seronegative:</th>
                <th>Irradiated:</th>
              </tr>
            </thead>
            
            <tr>
              <td>Neonates up to 28 days post EDD</td>
              <td><i class="fa fa-check"></i></td>
              <td>*</td>
            </tr>
            
            <tr>
              <td>Intrauterine Transfusion (IUT)</td>
              <td><i class="fa fa-check"></i></td>
              <td><i class="fa fa-check"></i>**</td>
            </tr>
            
            <tr>
              <td>Neonatal Exchange Transfusion (ET)</td>
              <td><i class="fa fa-check"></i></td>
              <td>***</td>
            </tr>
            
            <tr>
              <td>All donations from first or second degree relative</td>
              <td></td>
              <td><i class="fa fa-check"></i></td>
            </tr>
            
            <tr>
              <td>Severe T lymphocyte immunodeficiency syndromes including Di George and Severe Combined Immunodeficiency</td>
              <td><i class="fa fa-check"></i> <i class="fa fa-check"></i></td>
              <td><i class="fa fa-check"></i> <i class="fa fa-pause"></i>&#10014; &#10003;</td>
            </tr>
            
            
          </table>
          



        </div>
        
        <div style="padding: 10px;border: 0px; border-top: 5px solid black;" id="lothian">
          <i>Extract from NHS Lothian, Blood Transfusion Clinical Policy and Procedures 2013 (v.4), Appendic C: Special Requirements, pages 45-46:</i>
      
          <h3>Irradiated Components</h3>
          <p>For at-risk patients, all red cell, platelet and granulocyte concentrates should be irradiated. It is not necessary to irradiate FFP, cryoprecipitate or fractionated plasma products.</p>
          <ul>
            <li>All intrauterine transfusions.</li>
            <li>All exchange or top-up transfusions in infants where there has been a previous intra-uterine transfusion, until 6 months after the expected delivery date.</li>
            <li>Exchange transfusion, with no previous intra-uterine transfusion; irradiated blood is recommended provided this does not unduly delay transfusion.</li>
            <li>Proven or suspected congenital immunodeficiency states (including Severe Combined Immunodeficiency (SCID), Di George's syndrome, Wiskott-Aldrich syndrome, purine nucleoside phosphorylase deficiency, reticular dysgenesis, cell- mediated immunodeficiency (not otherwise classified), primary T lymphocyte immunodeficiencies, adenosine deaminase deficiency, MHC Class I and II deficiency, leucocyte adhesion deficiency, immunodeficiency with eosinophilia, ataxia telangiectasia, chronic mucocutaneous candidiasis).</li>
            <li>All autologous bone marrow or peripheral blood stem cell transplant recipients from start of conditioning until at least three months after transplant (or until at least six months after transplant if total body irradiation has been given).</li>
            <li>All allogeneic bone marrow or peripheral blood stem cell transplant recipients from start of conditioning until a minimum of six months after transplant; possibly longer at the discretion of the haematologist e.g. chronic GvHD.</li>
            <li>Blood transfused to allogeneic bone marrow or peripheral blood stem-cell donors for 7 days before the harvest and until after the last collection.</li>
            <li>Blood transfused to patients undergoing autologous bone marrow harvest for the 7 days before the harvest and until after the harvest.</li>
            <li>Blood transfused to patients undergoing autologous peripheral blood stem-cell mobilisation from commencement of the mobilising chemotherapy regimen and until the last collection.</li>
            <li>Patients with Hodgkin's disease, indefinitely.</li>
            <li>Patients treated with the purine analogue drugs Fludarabine, Deoxycoformycin, Cladribine, Clofarabine and Bendamustine, indefinitely.</li>
            <li>All transfusions from first- or second-degree relatives, even if the patient is immunocompetent.</li>
            <li>All HLA-matched platelet transfusions, even if the patient is immunocompetent.</li>
            <li>All granulocyte transfusions, which must then be transfused with minimum delay.</li>
            <li>Patients receiving ALG, ATG, CAMPATH or any other T-cell depleting agents (such as alemtuzumab for non-haematological indications including solid organ transplantation, multiple sclerosis and vasculitis) during treatment and then indefinitely.</li>
          </ul>
          <h3>CMV Negative Components</h3>
          <ul>
            <li>Intra-uterine transfusion irrespective of the CMV status of the mother.</li>
            <li>Pregnant women antenatally (pre-delivery only). If CMV negative components are not readily available and a delay will compromise the mother or baby, CMV random components (i.e. untested) are an acceptable alternative.</li>
            <li>All blood transfusions for infants up to 28 days post expected delivery date.</li>
          </ul>
        </div>
      </div>
    </div>
    <script type='text/javascript'>
      // http://jsfiddle.net/zeelux/B4vN2/
      (function() {
        'use strict';
        ko.extenders.paging = function(target, pageSize) {
          var _pageSize = ko.observable(pageSize || 10),
            // default pageSize to 10
            _currentPage = ko.observable(1); // default current page to 1
          target.pageSize = ko.computed({
            read: _pageSize,
            write: function(newValue) {
              if (newValue > 0) {
                _pageSize(newValue);
              } else {
                _pageSize(10);
              }
            }
          });
          target.currentPage = ko.computed({
            read: _currentPage,
            write: function(newValue) {
              if (newValue > target.pageCount()) {
                _currentPage(target.pageCount());
              } else if (newValue <= 0) {
                _currentPage(1);
              } else {
                _currentPage(newValue);
              }
              $("#questionContainer").trigger("create");
              $("#selector").selectmenu();
            }
          });
          target.pageCount = ko.computed(function() {
            return Math.ceil(target().length / target.pageSize()) || 1;
          });
          target.currentPageData = ko.computed(function() {
            var pageSize = _pageSize(),
              pageIndex = _currentPage(),
              startIndex = pageSize * (pageIndex - 1),
              endIndex = pageSize * pageIndex;
            return target().slice(startIndex, endIndex);
          });
          target.moveFirst = function() {
            target.currentPage(1);
          };
          target.movePrevious = function() {
            target.currentPage(target.currentPage() - 1);
          };
          target.moveNext = function() {
            target.currentPage(target.currentPage() + 1);
          };
          target.moveLast = function() {
            target.currentPage(target.pageCount());
          };
          return target;
        };
      }());
      ko.bindingHandlers.jqmEnhance = {
        update: function(element, valueAccessor) {
          // Get jQuery Mobile to enhance elements within this element
          $(element).trigger("create");
        }
      };
      var ViewModel = function() {
        this.questionBank = ko.observableArray([
          // Theme 1 - cellular
          {
            question: "Is the statement true or false?",
            value: "Removal of leucocytes from platelets and red cells reduces risk of CMV transmission.",
            options: ["Please select", "True", "False", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is the statement true or false?",
            value: "In the UK only red cells and platelets for patients with special requirements is leucodepleted.",
            options: ["Please select", "True", "False", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is the statement true or false?",
            value: "Leucodepletion is as effective as irradiation in the prevention of TA-GvHD.",
            options: ["Please select", "True", "False", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is the statement true or false?",
            value: "Some patients require CMV-negative components, even when leucodepleted.",
            options: ["Please select", "True", "False", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is the statement true or false?",
            value: "All red cell concentrate in the UK is irradiated.",
            options: ["Please select", "True", "False", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is the statement true or false?",
            value: "Platelets, white cells and red cells are examples of cellular blood components.",
            options: ["Please select", "True", "False", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is the statement true or false?",
            value: "Fresh Frozen Plasma is an example of a non-cellular blood component.",
            options: ["Please select", "True", "False", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is the statement true or false?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "True", "False", "Don't know"],
            selected: ko.observable("Please select")
          },
          // Theme 2 + TAGvHD
          
          

        {
          question: "Reports of unnecessary risks to patients with special requirements have been caused by...?",

          question: "What problems involving irradiated and CMV-negative blood been reported?",
          value: "Haemovigilance data suggests there is a lack of knowledge of the indications for special blood components among clinicians.",
          options: ["Please select", "Yes", "No", "Don't know"],
          selected: ko.observable("Please select")
        }, {
          question: "What problems involving special components have been reported?",
          value: "Failure to request blood according to local guidelines.",
          options: ["Please select", "Yes", "No", "Don't know"],
          selected: ko.observable("Please select")
        }, {
          question: "What problems involving special components have been reported?",
          value: "Poor communication between clinicians during shared patient care.",
          options: ["Please select", "Yes", "No", "Don't know"],
          selected: ko.observable("Please select")
        }, {
          question: "What problems involving special components have been reported?",
          value: "Radiation effects after transfusion of irradiated blood.",
          options: ["Please select", "Yes", "No", "Don't know"],
          selected: ko.observable("Please select")
        }, {
          question: "What problems involving special components have been reported?",
          value: "Mistaken patient identity at component collection and transfusion.",
          options: ["Please select", "Yes", "No", "Don't know"],
          selected: ko.observable("Please select")
        }, {
          question: "What problems involving special components have been reported?",
          value: "Transfusion of incorrectly stored components.",
          options: ["Please select", "Yes", "No", "Don't know"],
          selected: ko.observable("Please select")
        }, {
          question: "What problems involving special components have been reported?",
          value: "Erroneous data in laboratory information systems.",
          options: ["Please select", "Yes", "No", "Don't know"],
          selected: ko.observable("Please select")
        }, {
          question: "What problems involving special components have been reported?",
          value: "Unnecessary requests for special blood components.",
          options: ["Please select", "Yes", "No", "Don't know"],
          selected: ko.observable("Please select")
        },
          
          
          // OLD
          
          {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Viable donor lymphocytes in component.",
            options: ["Please select", "Yes", "No", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Recipient with low haemoglobin level.",
            options: ["Please select", "Yes", "No", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Shared HLA haplotype between donor and recipient",
            options: ["Please select", "Yes", "No", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Age of blood component.",
            options: ["Please select", "Yes", "No", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Recipient with HIV/AIDS.",
            options: ["Please select", "Yes", "No", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Granulocyte component.",
            options: ["Please select", "Yes", "No", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Fresh Frozen Plasma (FFP).",
            options: ["Please select", "Yes", "No", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Recipient with severe T-lymphocyte immunodeficiency.",
            options: ["Please select", "Yes", "No", "Don't know"],
            selected: ko.observable("Please select")
          },
          // Theme 3 - SHOT
          {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          },
          // Theme 4 - Indications
          {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          }, {
            question: "Is this a risk factor for TA-GvHD?",
            value: "Non-cellular components are unlikely to be associated with GvHD or CMV infection.",
            options: ["Please select", "Irradiated and CMV-negative", "Irradiated", "CMV-negative", "Special component not required", "Don't know"],
            selected: ko.observable("Please select")
          },
        ]).extend({
          paging: 4
        })
      };
      ko.applyBindings(new ViewModel());
      window.onload = function() {
        $("#pdfviewer").css("height", $(window).height() - $("#questionContainer").outerHeight() - $("#header").outerHeight() + "px");
      }
    </script>
  </body>

</html>